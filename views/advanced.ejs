<!DOCTYPE html>
<html>
	<head>
		<title><%= title %></title>
		<link rel='stylesheet' href='/stylesheets/style.css' />

		<script src="/js/lsse.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

		<script>
			var socket = io.connect();
			
			$(function(){
				
				var lsse = new LSSE(socket, '/find');
				
				$('#input_form').submit(function(){
					$('#result').empty();
					lsse.search($('#input_word').val(), $('#model').val(), function(data){
						var result = 'Nothing found!';
						if (data.result.length > 0)
						{
							result = '<span>Results count: ' + data.result.length + '</span>';
							data.result.sort(function(a, b){
								return b.value - a.value
							});
							var i;
							result += '<ol>';
							for(i = 0; i < data.result.length; i++)
							{
								result += ('<li><a href="#' + data.result[i].word + '">' + data.result[i].word + '</a> - ' + data.result[i].value + '</li>');
							}
							result += '</ol>';
						}
						$('#result').html(result);
					});
					return false;
				});
				$(document).on("click", "#result a", function(){
					$('#input_word').val($(this).attr('href').slice(1));
					$('#input_form').submit();

					return false;
				});
				$('#model').change(function(){
					$('#input_form').submit();
				});
			});
			
		</script>
	</head>
	<body>
		<% include nav %>
		<h1><%= title %></h1>
		<form action="?" id="input_form">
			<input type="text" placeholder="input word" id="input_word" />
			<select id="model">
				<% for(var i=0; i < models.length; i++) {%>
				   <option value="<%= models[i].alias %>"><%= models[i].name %></option>
				<% } %>
			</select>
			<input type="submit" value="Search" />
		</form>
		<div id="result">
			
		</div>

	</body>
</html>